2025-12-05 22:03:31,198 - __main__ - INFO - Loaded data with 405575 rows.
2025-12-05 22:03:31,319 - __main__ - INFO - Starting Feature Engineering (Generation)...
2025-12-05 22:03:31,405 - src.features.pedigree - INFO - Loaded horse data: 51238 records
2025-12-05 22:05:02,950 - __main__ - INFO - Generated columns: 132
2025-12-05 22:05:03,586 - __main__ - INFO - Train size: 324460, Test size: 81115
2025-12-05 22:05:03,588 - __main__ - INFO - Fitting Target Encoders on Training data...
2025-12-05 22:06:11,920 - __main__ - INFO - Applying Target Encoding...
2025-12-05 22:06:12,676 - __main__ - INFO - Final Feature Count: 99
2025-12-05 22:06:12,676 - __main__ - INFO - Features (Head): ['bracket', 'horse_num', 'gender', 'age', 'horse_weight', 'weight_change', 'surface', 'distance', 'weather', 'condition']
2025-12-05 22:06:12,773 - __main__ - INFO - Train size: 324460, Test size: 81115
2025-12-05 22:06:12,773 - __main__ - INFO - Training LightGBM...
2025-12-05 22:06:14,922 - __main__ - INFO - Evaluation Results - Accuracy: 0.9241, LogLoss: 0.2595, AUC: 0.6585
2025-12-05 22:06:14,932 - __main__ - INFO - Saved model to experiments/v2_feature_expansion/models/lgbm_v2.pkl
Training until validation scores don't improve for 50 rounds
Early stopping, best iteration is:
[9]	valid_0's binary_logloss: 0.259472

Top 20 Important Features:
                     feature  importance
98   horse_jockey_target_enc          92
14          final_corner_pos          40
78               odds_zscore          37
21               same_jockey          29
28                rank_5_min          16
18                 prev_rank          15
32               rank_10_min          13
24                rank_3_min          12
37               prize_5_sum           5
35               prize_3_sum           3
36              prize_5_mean           2
39              prize_10_sum           2
20             prev_agari_3f           1
34              prize_3_mean           1
38             prize_10_mean           1
26               rank_5_mean           1
73      trainer_win_rate_100           0
72      jockey_show_rate_100           0
71     jockey_place_rate_100           0
94  trainer_place_target_enc           0
